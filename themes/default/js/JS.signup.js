var signup_lng = new Array(); signup_lng['inprocess_vi-VN'] = 'Vui lòng chờ..'; signup_lng['inprocess_en-US'] = 'Please waiting..'; signup_lng['success_vi-VN'] = 'Cám ơn Quý khách đã đăng ký thành viên tại ' + SITE_NAME + '!.'; signup_lng['success_en-US'] = 'Thank you for registering at ' + SITE_NAME + '!.'; signup_lng['error_isset_email_vi-VN'] = 'Địa chỉ email này đã tồn tại trong hệ thống.'; signup_lng['error_isset_email_en-US'] = 'This email address already exists in the system.'; signup_lng['error_email_vi-VN'] = 'Email bắt buộc và phải đúng định dạng.'; signup_lng['error_email_en-US'] = 'Email incorrect format.'; signup_lng['error_missing_vi-VN'] = 'Vui lòng nhập thông tin đầy đủ.'; signup_lng['error_missing_en-US'] = 'Please fill in the form.'; function lockButton() { jQuery('#register').addClass('disabled'); jQuery('#register').attr('disabled','disabled'); } function enableButton() { jQuery('#register').removeClass('disabled'); jQuery('#register').removeAttr('disabled'); } document.frmSignup.email.focus(); jQuery(function(){ jQuery('#refreshimg').live('click', function(event){ event.preventDefault(); jQuery.post('/captcha-new-session'); jQuery('#captchaimage').load('/captcha-require', function(data,status) { if(status == 'success') jQuery('input#captcha').focus(); }); return false; }); }); jQuery(function() { var loader = jQuery('<div class="loader">' + signup_lng['inprocess_' + lang] + '</div>').css({position: 'fixed', top: '4em', right: '0.9em'}).appendTo('body').hide(); jQuery(document).ajaxStart(function() { loader.fadeIn(100).show(1); lockButton(); jQuery('div#showdata').hide(); }).ajaxStop(function() { loader.animate({'opacity': 1.0}, 500).fadeOut(100).hide(1); enableButton(); }).ajaxError(function(a, b, e) { throw e; }); var container = jQuery('div#showdata'); var v = jQuery('#frmSignup').validate({ debug: false, errorContainer: container, errorLabelContainer: jQuery('ol', container), meta: 'validate', submitHandler: function(form) { jQuery(form).ajaxSubmit({ resetForm: false, dataType: 'json', success: function(data,status) { if(data.code == 'success' && status == 'success') { v.resetForm(); alert(signup_lng['success_' + lang]); document.location.href = SIGNIN_URL; } else if(data.code == 'emailAddress') { alert(signup_lng['error_isset_email_' + lang]); jQuery('#email').focus(); } else if(data.code == 'invalidEmail') { alert(signup_lng['error_email_' + lang]); jQuery('#email').focus(); } else if(data.code == 'missingData') { alert(signup_lng['error_missing_' + lang]); jQuery('#name').focus(); } return false; } }); } }); jQuery('#clear').click(function() { v.resetForm(); jQuery('#email').focus(); }) });